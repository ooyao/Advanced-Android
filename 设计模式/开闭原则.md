## 开闭原则

***开闭原则（Open Closed Principle，OCP)*** 即`软件实体应当对扩展开放，对修改关闭`。

所谓的软件实体可以是项目中划分出的模块、类与接口、方法等。

即当应用的需求改变时，在补修改软件实体的源代码或者二进制代码的前提下，可以扩展模块的功能，使其满足新的需求。

开闭原则是设计的终极目标，其他原则都是为了实现开闭原则。

### 开闭原则的作用

开闭原则是面向对象程序设计的终极目标，它使软件实体拥有一定的适应性和灵活性的同时具备稳定性和延续性。具体来说，其作用如下：

1. 对软件测试的影响

   当软件遵守开闭原则时，在软件测试时只需要对扩展的代码进行测试就可以了，因为原有的测试代码仍然能够正常运行。

2. 可以提高代码的可复用性

   力度越小，被复用的可能性就越大；在面向对象的程序设计中，根据原子和抽象编程可以提高代码的可复用性。

3. 可以提高软件的可维护性

   遵守开闭原则的软件，其稳定性高、延续性强，从而易于扩展和维护。



### 开闭原则的实现方法

可以通过`抽象约束、封装变化`来实现开闭原则，及通过接口或抽象类为软件实体定义一个相对稳定的抽象层，而将相同的可变因素封装在相同的具体实现类中。



因为抽象灵活性好，适应性强，只要抽象的合理，可以基本保持软件架构的稳定性。而软件中易变的细节可以从抽象派生来的实现类来进行扩展，当软件需要发生变化时，只需要根据需求重新派生一个实现类来扩展就可以了。



例如缓存功能的设计如下图所示：



<img src="images/image-20210105224142261.png" alt="image-20210105224142261" style="zoom:50%;" />

客户端针对Cache接口编程，当需求从内存缓存转换成磁盘缓存后客户端的代码也不受影响，不需要修改源代码即可完成，所以满足了开闭原则。
